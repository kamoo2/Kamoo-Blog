---
title: '[JS] 브라우저 렌더링 과정과 최적화'
description: 브라우저 렌더링에 대해 알아보고 렌더링을 최적화하기 위한 방법에 대해서 알아보자.
thumbnail: '/images/posts/browser-rendering/231108-171637.png'
tags:
  - Javascript
createdAt: 2023-07-19 21:00:00
---

## 렌더링을 알아보기 전

브라우저 렌더링의 과정에 대해 알아보기 전에 DOM과 CSSOM, Render Tree에 대해 먼저 알아보자.

### DOM

브라우저 렌더링 과정에 대해 알아보기 전에 DOM에 대해 먼저 알아보자.
DOM(Document Object Model)은 HTML Tag를 Javascript에서 이해할 수 있는 `Node`로 변환한 것을 말한다.
그래서 우리는 Javascript에서 HTML 태그들에 접근을 할 수 있다.

### CSSOM

브라우저는 DOM과 CSS 요소를 합친 CSSOM(CSS Object Model)을 만들어 준다.
모든 것들이 계산된 스타일, 최종적으로 확정된 Style이 적용된 CSSOM을 만든다.

### Render Tree

DOM과 CSSOM을 합쳐서 실제로 렌더링 될 요소(사용자에게 최종적으로 보여질 요소)로만 구성된 트리이다.
DOM에 있는 head는 실제로 렌더링 되지 않기 때문에 제외되고 body만 가진다.
그리고 만약 CSSOM 중 display:none인 요소가 있다면 그 또한 제외된다.

## Critical Rendering Path

브라우저에 렌더링되는 순서는 다음과 같다.

1. requrest/response : 파일을 서버에 요청하고 파일을 받음
2. loading : 파일을 서버에게 받아서 로딩을 한다.
3. scripting : DOM과 CSSOM 생성
4. rendering : Rendering Tree 생성
5. layout : 각각의 요소들이 어떤 위치에 어떤 크기를 가지는지 계산
6. painting : 화면에 요소를 그린다.

위 과정을 하는 일에 따라 구분하면 다음과 같이 구분할 수 있다.

### Construction

DOM, CSSOM, RenderTree까지 만드는 과정을 Construction 파트로 분류한다.

### Operation

Construction이 끝난 후 RenderTree를 기반으로 화면에 그리고 최종적으로 사용자에게 보여지는 과정을 Operation 파트로 분류한다.
Operation 파트에는 3가지 과정이 있다.

- layout
  - Render Tree를 기반으로 요소의 위치와 크기 등을 계산하는 과정
- paint
  - 다른 z-index를 가진 요소가 있을 때 `레이어` 별로 준비를 하는 과정
  - 브라우저 성능 개선을 위해 레이어로 나누어 관리하므로 변경되는 요소가 있을 때 해당 레이어만 업데이트 한다.
  - z-index 뿐만 아니라 브라우저가 성능 개선을 위해 알아서 레이어를 나눈다.
- composition : paint에서 준비한 레이어를 브라우저 위에 그리는 과정

## 브라우저 렌더링 최적화

- Construction

  - 불필요한 html tag와 css를 최소화하면 DOM, CSSOM 최종적으로 Render Tree가 작아지기 때문에 더 빠른 속도로 Construction 작업을 할 수 있다.

- Operation
  - 최고의 성능을 내기 위해서는 composition만 일어나는 상황을 만드는 것 (EX.transition으로 이동)
  - paint가 다시 발생하는 repaints가 일어나게 되면 좋지 않다.
  - 최악의 경우는 layout부터 다시 발생하는 경우(reflows)는 절대적으로 피해야 한다.
